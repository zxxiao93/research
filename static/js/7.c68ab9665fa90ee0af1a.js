webpackJsonp([7],{146:function(e,t,a){a(602);var r=a(28)(a(329),a(623),null,null);e.exports=r.exports},329:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(56),s=a.n(r);t.default={data:function(){return{selectRows:[],filters:{keyword:"",value:"",options:[{value:"",label:"全部"},{value:"u_name",label:"姓名"},{value:"u_number",label:"学号"},{value:"u_identity",label:"身份证号"}]},self:this,loading:!0,currentPage:1,total:5,pageSize:10,tableColumns:[{type:"selection",width:60,align:"center"},{title:"ID",key:"u_id"},{title:"学号",key:"u_number"},{title:"姓名",key:"u_name"},{title:"性别",key:"u_sex",render:function(e,t,a){return"1"===e.u_sex?"女":"男"}},{title:"班级",key:"u_class"},{title:"身份证号",key:"u_identity"},{title:"出生日期",key:"u_birthday"},{title:"民族",key:"u_nation"},{title:"操作",key:"action",width:130,align:"center",render:function(e,t,a){return('<i-button type="primary" size="small" @click="update('+a+')">修改</i-button>\n                  <Poptip\n      placement="left"\n      confirm\n      title="您确认删除这条内容吗？"\n      width="200"\n      @on-ok="remove('+a+')">\n                    <i-button type="error" size="small">删除</i-button> </Poptip>').trim()}}],userData:[],sexList:[{value:"0",label:"男"},{value:"1",label:"女"}],addFormLoading:!1,updateUserRule:{u_name:[{required:!0,message:"请输入姓名",trigger:"blur"}],u_major:[{required:!0,message:"请输入专业名称",trigger:"blur"}],u_class:[{required:!0,message:"请输入班级",trigger:"blur"}],u_number:[{required:!0,message:"请输入学号",trigger:"blur"}],u_birthday:[{required:!0,message:"请输入出生日期",trigger:"blur"}],u_nation:[{required:!0,message:"请输入民族",trigger:"blur"}],u_sex:[{required:!0,message:"请选择性别",trigger:"change"}],u_identity:[{required:!0,message:"请输入身份证号",trigger:"blur"}]},addUserRule:{u_name:[{required:!0,message:"请输入姓名",trigger:"blur"}],u_major:[{required:!0,message:"请输入专业名称",trigger:"blur"}],u_class:[{required:!0,message:"请输入班级",trigger:"blur"}],u_number:[{required:!0,message:"请输入学号",trigger:"blur"}],u_birthday:[{required:!0,message:"请输入出生日期",trigger:"blur"}],u_nation:[{required:!0,message:"请输入民族",trigger:"blur"}],u_sex:[{required:!0,message:"请选择性别",trigger:"change"}],u_identity:[{required:!0,message:"请输入身份证号",trigger:"blur"}]},addUserForm:{u_name:"",u_major:"",u_class:"",u_number:"",u_birthday:"",u_nation:"",u_identity:"",u_sex:""},addUserModel:!1,updateFormLoading:!1,updateUserModel:!1,updateUserForm:{u_id:"",u_name:"",u_major:"",u_class:"",u_number:"",u_birthday:"",u_nation:"",u_identity:"",u_sex:""}}},methods:{selectionChange:function(e){console.log(e),this.selectRows=e},update:function(e){var t=this;this.$http.get("/api/user",{params:{u_id:this.userData[e].u_id}}).then(function(e){console.log(e.data.data),0===e.data.err&&(t.updateUserForm=e.data.data[0],t.updateUserModel=!0)}).catch(function(e){console.log(e),t.$Message.error("获取用户数据失败")})},remove:function(e){var t=this;this.$http.post("/api/user/del",{u_id:this.userData[e].u_id}).then(function(a){a.data.data>0&&0===a.data.err&&(t.$Message.success("成功删除"+a.data.data+"个用户"),t.userData.splice(e,1))}).catch(function(e){console.log(e),t.$Message.error("删除失败")})},betchRemove:function(){var e=this,t=[];this.selectRows.forEach(function(e){var a=e.u_id;t.push(a)}),this.$http.post("/api/user/del",{u_id:t+""}).then(function(t){t.data.data>0&&0===t.data.err&&(e.$Message.success("成功删除"+t.data.data+"个用户"),e.getData())}).catch(function(t){console.log(t),e.$Message.error("删除失败")})},changePage:function(e){var t=this;console.log(e),this.loading=!0,this.currentPage=e,this.$http.get("/api/user",{params:{current:e,page_size:this.pageSize}}).then(function(e){t.userData=e.data.data,t.total=e.data.total,t.loading=!1}).catch(function(e){console.log(e),t.$Message.error("网络错误，请重试")})},getData:function(){var e=this;this.$http.get("/api/user",{params:{keyword:this.filters.keyword,value:this.filters.value,current:this.currentPage,page_size:this.pageSize}}).then(function(t){e.userData=t.data.data,e.total=t.data.total,e.loading=!1}).catch(function(t){console.log(t),e.$Message.error("网络错误，请重试")})},handleFormatError:function(e){this.$Notice.warning({title:"文件格式不正确",desc:"文件 "+e.name+" 格式不正确，请上传 xls 或 xlsx 格式的文件。"})},handleMaxSize:function(e){this.$Notice.warning({title:"超出文件大小限制",desc:"文件 "+e.name+" 太大，不能超过 2M。"})},handleSuccess:function(e,t,a){console.log(e),0===e.err?(this.$Message.success(e.msg),this.getData()):this.$Message.error("上传出错")},handleError:function(e,t,a){console.log(e),this.$Message.error("上传出错")},handleAdd:function(){this.addUserModel=!0},updateUser:function(e){var t=this;this.$refs[e].validate(function(a){a?t.$http.post("/api/user/updateUser",s()({},t.updateUserForm)).then(function(a){console.log(a.data.data),0===a.data.err?(t.$Message.success(a.data.data),t.updateUserModel=!1,t.$refs[e].resetFields(),t.getData()):t.$Message.error(a.data.data)}).catch(function(e){console.log(e),t.$Message.error("修改失败")}):t.$Message.error("表单校验失败！")})},submitUser:function(e){var t=this;this.$refs[e].validate(function(a){a?t.$http.post("/api/user/addUser",s()({},t.addUserForm)).then(function(a){0===a.data.err?(t.$Message.success(a.data.data),t.addUserModel=!1,t.$refs[e].resetFields(),t.getData()):t.$Message.error(a.data.data)}).catch(function(e){console.log(e),t.$Message.error("新增失败")}):t.$Message.error("表单校验失败！")})}},created:function(){this.getData()}}},335:function(e,t,a){t=e.exports=a(133)(!1),t.push([e.i,"",""])},602:function(e,t,a){var r=a(335);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(134)("498c8409",r,!0)},623:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user"},[a("Row",{staticStyle:{"padding-bottom":"10px"},attrs:{type:"flex",justify:"start"}},[a("Col",{staticStyle:{width:"100px"},attrs:{span:"2"}},[a("Button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[e._v("新增用户")])],1),e._v(" "),a("Col",{staticStyle:{width:"120px"},attrs:{span:"3"}},[a("Upload",{attrs:{action:"/api/user/upload",accept:"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",name:"userfile","show-upload-list":!1,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"on-success":e.handleSuccess,"on-error":e.handleError}},[a("Button",{attrs:{type:"ghost",icon:"ios-cloud-upload-outline"}},[e._v("批量导入")])],1)],1),e._v(" "),a("Col",{staticStyle:{"margin-right":"20px"},attrs:{span:"4"}},[a("Select",{attrs:{placeholder:"搜索类别"},model:{value:e.filters.keyword,callback:function(t){e.filters.keyword=t},expression:"filters.keyword"}},e._l(e.filters.options,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label)+"\n            ")])}))],1),e._v(" "),a("Col",{staticStyle:{"margin-right":"20px"},attrs:{span:"4"}},[a("Input",{attrs:{placeholder:"搜索内容"},model:{value:e.filters.value,callback:function(t){e.filters.value=t},expression:"filters.value"}})],1),e._v(" "),a("Col",{attrs:{span:"4"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.getData}},[e._v("搜索用户")])],1)],1),e._v(" "),a("Row",[a("Col",{attrs:{span:"24"}},[e.loading?a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"load-c",size:"18"}}),e._v(" "),a("div",[e._v("数据加载中...")])],1):e._e(),e._v(" "),e.loading?e._e():a("Table",{attrs:{border:"",context:e.self,columns:e.tableColumns,data:e.userData},on:{"on-selection-change":e.selectionChange}}),e._v(" "),a("div",{staticStyle:{margin:"10px 0 10px 0",overflow:"hidden"}},[e.loading?e._e():a("div",{staticStyle:{float:"left"}},[a("Poptip",{attrs:{placement:"right",confirm:"",title:"您确认删除这几条内容吗？",width:"200"},on:{"on-ok":e.betchRemove}},[a("i-button",{attrs:{type:"error"}},[e._v("批量删除")])],1)],1),e._v(" "),e.loading?e._e():a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.total,current:e.currentPage,"page-size":e.pageSize},on:{"on-change":e.changePage}})],1)])],1)],1),e._v(" "),a("Modal",{attrs:{title:"新增用户","mask-closable":!1},model:{value:e.addUserModel,callback:function(t){e.addUserModel=t},expression:"addUserModel"}},[a("Form",{ref:"addUser",staticClass:"form",attrs:{model:e.addUserForm,rules:e.addUserRule,"label-width":80}},[a("FormItem",{attrs:{label:"姓名",prop:"u_name"}},[a("Input",{attrs:{placeholder:""},model:{value:e.addUserForm.u_name,callback:function(t){e.addUserForm.u_name=t},expression:"addUserForm.u_name"}})],1),e._v(" "),a("FormItem",{attrs:{label:"专业名称",prop:"u_major"}},[a("Input",{attrs:{placeholder:""},model:{value:e.addUserForm.u_major,callback:function(t){e.addUserForm.u_major=t},expression:"addUserForm.u_major"}})],1),e._v(" "),a("FormItem",{attrs:{label:"班级名称",prop:"u_class"}},[a("Input",{attrs:{placeholder:""},model:{value:e.addUserForm.u_class,callback:function(t){e.addUserForm.u_class=t},expression:"addUserForm.u_class"}})],1),e._v(" "),a("FormItem",{attrs:{label:"学号",prop:"u_number"}},[a("Input",{attrs:{placeholder:""},model:{value:e.addUserForm.u_number,callback:function(t){e.addUserForm.u_number=t},expression:"addUserForm.u_number"}})],1),e._v(" "),a("FormItem",{attrs:{label:"出生日期",prop:"u_birthday"}},[a("Input",{attrs:{placeholder:"格式：20171001"},model:{value:e.addUserForm.u_birthday,callback:function(t){e.addUserForm.u_birthday=t},expression:"addUserForm.u_birthday"}})],1),e._v(" "),a("FormItem",{attrs:{label:"民族",prop:"u_nation"}},[a("Input",{attrs:{placeholder:""},model:{value:e.addUserForm.u_nation,callback:function(t){e.addUserForm.u_nation=t},expression:"addUserForm.u_nation"}})],1),e._v(" "),a("FormItem",{attrs:{label:"身份证号",prop:"u_identity"}},[a("Input",{attrs:{placeholder:"如最后为字母，以大写结尾"},model:{value:e.addUserForm.u_identity,callback:function(t){e.addUserForm.u_identity=t},expression:"addUserForm.u_identity"}})],1),e._v(" "),a("FormItem",{attrs:{label:"性别",prop:"u_sex"}},[a("RadioGroup",{model:{value:e.addUserForm.u_sex,callback:function(t){e.addUserForm.u_sex=t},expression:"addUserForm.u_sex"}},e._l(e.sexList,function(t){return a("Radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label)+"\n                    ")])}))],1)],1),e._v(" "),a("div",{slot:"footer"},[a("Button",{attrs:{type:"primary",loading:e.addFormLoading},on:{click:function(t){e.submitUser("addUser")}}},[e._v("提交")]),e._v(" "),a("Button",{on:{click:function(t){e.addUserModel=!1}}},[e._v("关闭")])],1)],1),e._v(" "),a("Modal",{attrs:{title:"新增用户","mask-closable":!1},model:{value:e.updateUserModel,callback:function(t){e.updateUserModel=t},expression:"updateUserModel"}},[a("Form",{ref:"updateUser",staticClass:"form",attrs:{model:e.updateUserForm,rules:e.updateUserRule,"label-width":80}},[a("FormItem",{attrs:{label:"姓名",prop:"u_name"}},[a("Input",{attrs:{placeholder:""},model:{value:e.updateUserForm.u_name,callback:function(t){e.updateUserForm.u_name=t},expression:"updateUserForm.u_name"}})],1),e._v(" "),a("FormItem",{attrs:{label:"专业名称",prop:"u_major"}},[a("Input",{attrs:{placeholder:""},model:{value:e.updateUserForm.u_major,callback:function(t){e.updateUserForm.u_major=t},expression:"updateUserForm.u_major"}})],1),e._v(" "),a("FormItem",{attrs:{label:"班级名称",prop:"u_class"}},[a("Input",{attrs:{placeholder:""},model:{value:e.updateUserForm.u_class,callback:function(t){e.updateUserForm.u_class=t},expression:"updateUserForm.u_class"}})],1),e._v(" "),a("FormItem",{attrs:{label:"学号",prop:"u_number"}},[a("Input",{attrs:{placeholder:""},model:{value:e.updateUserForm.u_number,callback:function(t){e.updateUserForm.u_number=t},expression:"updateUserForm.u_number"}})],1),e._v(" "),a("FormItem",{attrs:{label:"出生日期",prop:"u_birthday"}},[a("Input",{attrs:{placeholder:"格式：20171001"},model:{value:e.updateUserForm.u_birthday,callback:function(t){e.updateUserForm.u_birthday=t},expression:"updateUserForm.u_birthday"}})],1),e._v(" "),a("FormItem",{attrs:{label:"民族",prop:"u_nation"}},[a("Input",{attrs:{placeholder:""},model:{value:e.updateUserForm.u_nation,callback:function(t){e.updateUserForm.u_nation=t},expression:"updateUserForm.u_nation"}})],1),e._v(" "),a("FormItem",{attrs:{label:"身份证号",prop:"u_identity"}},[a("Input",{attrs:{placeholder:"如最后为字母，以大写结尾"},model:{value:e.updateUserForm.u_identity,callback:function(t){e.updateUserForm.u_identity=t},expression:"updateUserForm.u_identity"}})],1),e._v(" "),a("FormItem",{attrs:{label:"性别",prop:"u_sex"}},[a("RadioGroup",{model:{value:e.updateUserForm.u_sex,callback:function(t){e.updateUserForm.u_sex=t},expression:"updateUserForm.u_sex"}},e._l(e.sexList,function(t){return a("Radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label)+"\n                    ")])}))],1)],1),e._v(" "),a("div",{slot:"footer"},[a("Button",{attrs:{type:"primary",loading:e.updateFormLoading},on:{click:function(t){e.updateUser("updateUser")}}},[e._v("提交")]),e._v(" "),a("Button",{on:{click:function(t){e.updateUserModel=!1}}},[e._v("关闭")])],1)],1)],1)},staticRenderFns:[]}}});