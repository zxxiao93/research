webpackJsonp([4],{139:function(t,e,o){o(609);var i=o(28)(o(322),o(630),null,null);t.exports=i.exports},217:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["questionList","isPreview"],methods:{delQuestion:function(t){console.log(t),this.$store.dispatch("delQuestion",t)},delOption:function(t,e){console.log(t,e),this.$store.dispatch("delOption",{index:t,opIndex:e})}},created:function(){console.log("imported successfully",this.questionList,this.isPreview)}}},218:function(t,e,o){e=t.exports=o(133)(!1),e.push([t.i,".question-list[data-v-200a39eb]{padding:30px 0;overflow:visible}.checkbox-list label[data-v-200a39eb]{display:block}.question-options[data-v-200a39eb]{padding:5px 0}.option-item[data-v-200a39eb]{margin:5px 0}.question-desc[data-v-200a39eb]{padding:5px 0}.question-action[data-v-200a39eb]{display:none;color:#a9afb2}.question-item[data-v-200a39eb]{padding:20px 0;min-width:300px}.question-item[data-v-200a39eb]:hover{background:hsla(0,0%,93%,.47)}.question-item:hover .question-action[data-v-200a39eb]{display:block;margin-top:8px}.question-action[data-v-200a39eb]:hover{color:#018fe5;cursor:pointer}.question-btns[data-v-200a39eb]{margin-top:20px}.option-action[data-v-200a39eb]{display:none;margin-left:100px;padding:0 10px;text-align:right;color:#a9afb2}.option-action[data-v-200a39eb]:hover{color:#018fe5}.option-item:hover .option-action[data-v-200a39eb]{display:inline-block;cursor:pointer}",""])},236:function(t,e,o){var i=o(218);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o(134)("5583ec03",i,!0)},237:function(t,e,o){o(236);var i=o(28)(o(217),o(238),"data-v-200a39eb",null);t.exports=i.exports},238:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("Row",{staticClass:"question-wrapper"},[o("Col",{staticClass:"question-list",attrs:{span:"24"}},[0==t.questionList.length?o("p",{staticStyle:{margin:"10px 0"}},[t._v("一点东西都没有，赶快点击上方按钮添加题目吧！")]):t._e(),t._v(" "),t._l(t.questionList,function(e,i){return o("Row",{key:e.q_id,staticClass:"question-item",attrs:{type:"flex",justify:"start",align:"top"}},[o("Col",{staticStyle:{width:"60px","text-align":"center"},attrs:{span:"6"}},[o("h2",[t._v("Q"+t._s(i+1)+":")]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.isPreview,expression:"isPreview"}],staticClass:"question-action",on:{click:function(e){t.delQuestion(i)}}},[o("Icon",{attrs:{type:"trash-a",size:"18"}})],1)]),t._v(" "),o("Col",{attrs:{span:"18"}},[o("h3",[t._v("["+t._s(e.type)+"] "+t._s(e.question)+t._s(e.isRequired?"（必填）":"（选填）")+" "),e.isRequired?o("span",{staticStyle:{color:"#f00"}},[t._v("*")]):t._e()]),t._v(" "),""!==e.description?o("p",{staticClass:"question-desc"},[t._v("说明："+t._s(e.description))]):t._e(),t._v(" "),o("div",{staticClass:"question-options"},["单选"===e.type?o("div",[o("Radio-group",{staticStyle:{width:"100%"},attrs:{vertical:""},model:{value:e.selectContent,callback:function(t){e.selectContent=t},expression:"topic.selectContent"}},t._l(e.options,function(a,s){return o("Radio",{key:a.o_id,staticClass:"option-item",attrs:{label:a.o_id,disabled:t.isPreview}},[o("span",[t._v(t._s(a.content))]),t._v(" "),a.isAddition?o("Input",{directives:[{name:"show",rawName:"v-show",value:a.isAddition&&e.selectContent===a.o_id,expression:"option.isAddition && topic.selectContent === option.o_id "}],staticStyle:{width:"300px"},attrs:{placeholder:"请输入理由"},model:{value:e.additional,callback:function(t){e.additional=t},expression:"topic.additional"}}):t._e(),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.isPreview,expression:"isPreview"}],staticClass:"option-action",on:{click:function(e){t.delOption(i,s)}}},[o("Icon",{attrs:{type:"close",size:"16"}})],1)],1)}))],1):t._e(),t._v(" "),"多选"===e.type?o("div",[o("Checkbox-group",{staticClass:"checkbox-list",model:{value:e.selectMultipleContent,callback:function(t){e.selectMultipleContent=t},expression:"topic.selectMultipleContent"}},t._l(e.options,function(e,a){return o("Checkbox",{key:e.o_id,staticClass:"option-item",attrs:{label:e.o_id,disabled:t.isPreview}},[o("span",[t._v(t._s(e.content))]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.isPreview,expression:"isPreview"}],staticClass:"option-action",on:{click:function(e){t.delOption(i,a)}}},[o("Icon",{attrs:{type:"close",size:"16"}})],1)])}))],1):t._e(),t._v(" "),"文本"===e.type?o("div",{staticClass:"option-item"},[o("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入...",disabled:t.isPreview},model:{value:e.selectContent,callback:function(t){e.selectContent=t},expression:"topic.selectContent"}})],1):t._e()])])],1)}),t._v(" "),o("div",{staticClass:"question-btns"},[t._t("default")],2)],2)],1)},staticRenderFns:[]}},322:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(56),a=o.n(i),s=o(237),n=o.n(s);e.default={data:function(){return{addRadio_modal:!1,addRadio_loading:!1,addRadio_form:{},addCheckbox_modal:!1,addCheckbox_loading:!1,addCheckbox_form:{},addTextarea_modal:!1,addTextarea_loading:!1,addTextarea_form:{},dateOption:{disabledDate:function(t){return t&&t.valueOf()<Date.now()-864e5}},textarea:""}},computed:{naire:function(){return this.$store.getters.naire},title:{get:function(){return this.$store.getters.naire.title},set:function(t){this.$store.commit("UPDATE_TITLE",t)}},intro:{get:function(){return this.textarea=this.$store.getters.naire.intro,this.$store.getters.intro},set:function(t){this.$store.commit("UPDATE_INTRO",t)}},deadline:{get:function(){return this.$store.getters.naire.deadline},set:function(t){console.log(t),this.$store.commit("UPDATE_DEADLINE",new Date(t).getTime())}}},created:function(){this.fetchData()},watch:{$route:"fetchData"},methods:{warning:function(t,e,o){this.$Notice.warning({title:e,desc:t?"":o})},error:function(t,e,o){this.$Notice.error({title:e,desc:t?"":o})},validQuestion:function(t){var e=!0;return""===t.question&&(this.warning(!1,"题目","请输入问题内容"),e=!1),t.options.length<1&&(this.warning(!1,"选项","选项至少增加一个"),e=!1),t.options.some(function(t,e){return""===t.content})&&(this.warning(!1,"选项内容","请输入选项内容"),e=!1),e},validNaire:function(){var t=!0;return""===this.title&&(this.warning(!1,"问卷标题","请输入问卷标题"),this.$refs.title.focus(),t=!1),""!==this.deadline&&this.deadline||(this.warning(!1,"截止时间","请选择问卷截止时间"),t=!1),this.naire.topic.length<1&&(this.warning(!1,"问卷题目","请至少添加一道问卷题目"),t=!1),t},updateIntro:function(t){this.$store.commit("UPDATE_INTRO",t.target.value)},handleSave:function(){this.validNaire()&&(this.$store.dispatch("changeNaireStatus",0),this.saveNaire("保存失败，请重试"))},handlePublish:function(){this.validNaire()&&(this.$store.dispatch("changeNaireStatus",1),this.saveNaire("发布失败，请重试"))},addRadio:function(){this.addRadio_modal=!0;var t={question:"单选题目",options:[],description:"",type:"单选",isRequired:!0,selectContent:"",additional:""};this.addRadio_form=a()({},t);var e={content:"选项",isAddition:!1};this.addRadio_form.options.splice(0,this.addRadio_form.options.length,a()({},e))},addCheckbox:function(){this.addCheckbox_modal=!0;var t={question:"多选题目",options:[],description:"",type:"多选",isRequired:!0,selectMultipleContent:[]};this.addCheckbox_form=a()({},t);var e={content:"选项",isAddition:!1};this.addCheckbox_form.options.splice(0,this.addCheckbox_form.options.length,a()({},e))},addTextarea:function(){this.addTextarea_modal=!0;var t={question:"文本题目",description:"",type:"文本",isRequired:!0,selectContent:""};this.addTextarea_form=a()({},t)},addOption:function(t){var e={content:"选项",isAddition:!1};t.push(a()({},e))},delOption:function(t,e){t.length>1?t.splice(e,1):this.$Message.warning("最后一个啦，不要删除哦")},submitRadio:function(t){if(this.validQuestion(this.addRadio_form)){var e=a()({},this.addRadio_form);this.$store.dispatch("addQuestion",e),this.addRadio_modal=!1}},submitCheckbox:function(t){if(this.validQuestion(this.addCheckbox_form)){var e=a()({},this.addCheckbox_form);this.$store.dispatch("addQuestion",e),this.addCheckbox_modal=!1}},submitTextarea:function(t){if(""===this.addTextarea_form.question)return void this.warning(!1,"题目","请输入问题内容");var e=a()({},this.addTextarea_form);this.$store.dispatch("addQuestion",e),this.addTextarea_modal=!1},closeRadioModal:function(){this.addRadio_modal=!1},closeCheckboxModal:function(){this.addCheckbox_modal=!1},closeTextareaModal:function(){this.addTextarea_modal=!1},fetchData:function(){if(this.$route.params.id)this.$store.dispatch("getQuestionList"),this.$store.dispatch("changeStatus","update");else{var t={title:"",deadline:"",intro:"",status:0,topic:[]},e=a()({},t);this.$store.dispatch("createNaire",e),this.$store.dispatch("changeStatus","create")}},saveNaire:function(t){var e=this;this.$store.dispatch("saveNewNaire").then(function(t){console.log(t.data),0===t.data.err?(e.$Message.success(t.data.data),e.$router.push("/platform/list")):e.$Message.error(t.data.data)}).catch(function(o){console.log(o),e.$Message.error(t)})}},components:{questionList:n.a}}},342:function(t,e,o){e=t.exports=o(133)(!1),e.push([t.i,".option-btn{padding-left:10px}.option-item{padding:5px 0}.option-addtion{height:30px;line-height:30px}.add-button button{margin:0 10px}",""])},609:function(t,e,o){var i=o(342);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o(134)("723778bf",i,!0)},630:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"edit"},[o("Row",[o("Col",{attrs:{span:"24"}},[o("Form",{attrs:{model:t.naire,"label-width":80}},[o("Form-item",{attrs:{label:"问卷名"}},[o("Input",{ref:"title",attrs:{placeholder:"问卷名"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),t._v(" "),o("Form-item",{attrs:{label:"问卷介绍"}},[o("Input",{attrs:{type:"textarea",autosize:{minRows:8,maxRows:10},placeholder:"请输入问卷介绍..."},on:{"on-change":t.updateIntro},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}})],1)],1)],1)],1),t._v(" "),o("Row",{staticClass:"add-button",attrs:{type:"flex",justify:"center",align:"middle"}},[o("Button",{attrs:{type:"primary"},on:{click:t.addRadio}},[t._v("单选题")]),t._v(" "),o("Button",{attrs:{type:"primary"},on:{click:t.addCheckbox}},[t._v("多选题")]),t._v(" "),o("Button",{attrs:{type:"primary"},on:{click:t.addTextarea}},[t._v("文本题")])],1),t._v(" "),o("questionList",{attrs:{"question-list":t.naire.topic,"is-preview":!0}},[o("Row",[o("Col",{staticStyle:{"margin-right":"10px"},attrs:{span:"4"}},[o("Date-picker",{attrs:{type:"datetime",placeholder:"截止日期",editable:!1,placement:"right-end",options:t.dateOption},model:{value:t.deadline,callback:function(e){t.deadline=e},expression:"deadline"}})],1),t._v(" "),o("Col",{attrs:{span:"12"}},[o("Button",{staticStyle:{"margin-right":"10px"},on:{click:t.handleSave}},[t._v("保存问卷")]),t._v(" "),o("Button",{attrs:{type:"success"},on:{click:t.handlePublish}},[t._v("发布问卷")])],1)],1)],1),t._v(" "),o("Modal",{attrs:{title:"添加单选题","mask-closable":!1},model:{value:t.addRadio_modal,callback:function(e){t.addRadio_modal=e},expression:"addRadio_modal"}},[o("Form",{ref:"addRadio",staticClass:"form",attrs:{"label-width":80},model:{value:t.addRadio_form,callback:function(e){t.addRadio_form=e},expression:"addRadio_form"}},[o("Form-item",{attrs:{label:"题目",prop:"title"}},[o("Input",{attrs:{placeholder:"请输入题目内容"},model:{value:t.addRadio_form.question,callback:function(e){t.addRadio_form.question=e},expression:"addRadio_form.question"}})],1),t._v(" "),o("Form-item",{attrs:{label:"题目说明",prop:"description"}},[o("Input",{attrs:{placeholder:"请输入题目说明，可以为空"},model:{value:t.addRadio_form.description,callback:function(e){t.addRadio_form.description=e},expression:"addRadio_form.description"}})],1),t._v(" "),o("Form-item",{attrs:{label:"选项",prop:"title"}},t._l(t.addRadio_form.options,function(e,i){return o("div",{staticClass:"option-item"},[o("Row",[o("Col",{attrs:{span:"18"}},[o("Input",{key:i,staticStyle:{display:"inline-block"},attrs:{placeholder:"请输入选项内容"},model:{value:e.content,callback:function(t){e.content=t},expression:"option.content"}})],1),t._v(" "),o("Col",{attrs:{span:"6"}},[o("div",{staticClass:"option-btn"},[o("Button",{attrs:{type:"success",icon:"plus-round",size:"small"},on:{click:function(e){t.addOption(t.addRadio_form.options)}}}),t._v(" "),o("Button",{attrs:{type:"warning",icon:"close",size:"small"},on:{click:function(e){t.delOption(t.addRadio_form.options,i)}}})],1)])],1),t._v(" "),o("div",{staticClass:"option-addtion"},[t._v("\n            是否有附加说明内容：\n            "),o("i-switch",{model:{value:e.isAddition,callback:function(t){e.isAddition=t},expression:"option.isAddition"}},[o("span",{slot:"open"},[t._v("有")]),t._v(" "),o("span",{slot:"close"},[t._v("无")])])],1)],1)})),t._v(" "),o("Form-item",{attrs:{label:"必填项"}},[o("div",{staticClass:"option-addtion"},[o("i-switch",{model:{value:t.addRadio_form.isRequired,callback:function(e){t.addRadio_form.isRequired=e},expression:"addRadio_form.isRequired"}},[o("span",{slot:"open"},[t._v("是")]),t._v(" "),o("span",{slot:"close"},[t._v("否")])])],1)])],1),t._v(" "),o("div",{slot:"footer"},[o("Button",{attrs:{type:"primary",loading:t.addRadio_loading},on:{click:function(e){t.submitRadio("addRadio")}}},[t._v("提交")]),t._v(" "),o("Button",{on:{click:t.closeRadioModal}},[t._v("关闭")])],1)],1),t._v(" "),o("Modal",{attrs:{title:"添加多选题","mask-closable":!1},model:{value:t.addCheckbox_modal,callback:function(e){t.addCheckbox_modal=e},expression:"addCheckbox_modal"}},[o("Form",{ref:"addCheckbox",staticClass:"form",attrs:{model:t.addCheckbox_form,"label-width":80}},[o("Form-item",{attrs:{label:"题目",prop:"title"}},[o("Input",{attrs:{placeholder:"请输入题目内容"},model:{value:t.addCheckbox_form.question,callback:function(e){t.addCheckbox_form.question=e},expression:"addCheckbox_form.question"}})],1),t._v(" "),o("Form-item",{attrs:{label:"题目说明",prop:"description"}},[o("Input",{attrs:{placeholder:"请输入题目说明，可以为空"},model:{value:t.addCheckbox_form.description,callback:function(e){t.addCheckbox_form.description=e},expression:"addCheckbox_form.description"}})],1),t._v(" "),o("Form-item",{attrs:{label:"选项",prop:"title"}},t._l(t.addCheckbox_form.options,function(e,i){return o("div",{staticClass:"option-item"},[o("Row",[o("Col",{attrs:{span:"18"}},[o("Input",{key:i,staticStyle:{display:"inline-block"},attrs:{placeholder:"请输入选项内容"},model:{value:e.content,callback:function(t){e.content=t},expression:"option.content"}})],1),t._v(" "),o("Col",{attrs:{span:"6"}},[o("div",{staticClass:"option-btn"},[o("Button",{attrs:{type:"success",icon:"plus-round",size:"small"},on:{click:function(e){t.addOption(t.addCheckbox_form.options)}}}),t._v(" "),o("Button",{attrs:{type:"warning",icon:"close",size:"small"},on:{click:function(e){t.delOption(t.addCheckbox_form.options,i)}}})],1)])],1),t._v(" "),o("div",{staticClass:"option-addtion"},[t._v("\n            是否有附加说明内容：\n            "),o("i-switch",{attrs:{disabled:""},model:{value:e.isAddition,callback:function(t){e.isAddition=t},expression:"option.isAddition"}},[o("span",{slot:"open"},[t._v("有")]),t._v(" "),o("span",{slot:"close"},[t._v("无")])])],1)],1)})),t._v(" "),o("Form-item",{attrs:{label:"必填项"}},[o("div",{staticClass:"option-addtion"},[o("i-switch",{model:{value:t.addCheckbox_form.isRequired,callback:function(e){t.addCheckbox_form.isRequired=e},expression:"addCheckbox_form.isRequired"}},[o("span",{slot:"open"},[t._v("是")]),t._v(" "),o("span",{slot:"close"},[t._v("否")])])],1)])],1),t._v(" "),o("div",{slot:"footer"},[o("Button",{attrs:{type:"primary",loading:t.addCheckbox_loading},on:{click:function(e){t.submitCheckbox("addCheckbox")}}},[t._v("提交")]),t._v(" "),o("Button",{on:{click:t.closeCheckboxModal}},[t._v("关闭")])],1)],1),t._v(" "),o("Modal",{attrs:{title:"添加文本题","mask-closable":!1},model:{value:t.addTextarea_modal,callback:function(e){t.addTextarea_modal=e},expression:"addTextarea_modal"}},[o("Form",{ref:"addTextarea",staticClass:"form",attrs:{model:t.addTextarea_form,"label-width":80}},[o("Form-item",{attrs:{label:"题目",prop:"title"}},[o("Input",{attrs:{placeholder:"请输入题目内容"},model:{value:t.addTextarea_form.question,callback:function(e){t.addTextarea_form.question=e},expression:"addTextarea_form.question"}})],1),t._v(" "),o("Form-item",{attrs:{label:"题目说明",prop:"description"}},[o("Input",{attrs:{placeholder:"请输入题目说明，可以为空"},model:{value:t.addTextarea_form.description,callback:function(e){t.addTextarea_form.description=e},expression:"addTextarea_form.description"}})],1),t._v(" "),o("Form-item",{attrs:{label:"必填项"}},[o("div",{staticClass:"option-addtion"},[o("i-switch",{model:{value:t.addTextarea_form.isRequired,callback:function(e){t.addTextarea_form.isRequired=e},expression:"addTextarea_form.isRequired"}},[o("span",{slot:"open"},[t._v("是")]),t._v(" "),o("span",{slot:"close"},[t._v("否")])])],1)])],1),t._v(" "),o("div",{slot:"footer"},[o("Button",{attrs:{type:"primary",loading:t.addTextarea_loading},on:{click:function(e){t.submitTextarea("addTextarea")}}},[t._v("提交")]),t._v(" "),o("Button",{on:{click:t.closeTextareaModal}},[t._v("关闭")])],1)],1)],1)},staticRenderFns:[]}}});